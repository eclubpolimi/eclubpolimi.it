## Quick orientation for AI coding assistants

This file contains concise, repo-specific guidance so an AI agent can be immediately productive in this Astro + React codebase.

- **Project type:** Astro app using React components and Tailwind CSS. Server output is configured for Vercel (`@astrojs/vercel`).
- **Primary folders:** `src/components` (UI + pages components), `src/pages` (Astro routes), `src/lib` (data adapters), `generated/` and `src/site-components` (Webflow-generated assets).

### How the app runs

- Dev: `npm install` then `npm run dev` (there's a `predev` step that runs `npx kill-port 3000`).
- Build: `npm run build`; Preview: `npm run preview`.
- Note: `astro.config.mjs` sets `server.port = 3000` (so expect the dev server on port `3000` even if older docs reference `4321`).

### Key integration points (search these files first)

- `src/lib/contentful.ts` — GraphQL queries and helper functions used by pages to fetch Contentful data. Environment variables: `CONTENTFUL_SPACE_ID`, `CONTENTFUL_ENVIRONMENT`, `CONTENTFUL_DELIVERY_TOKEN`, `CONTENTFUL_PREVIEW_TOKEN` (available via `import.meta.env`). Example usage: `src/pages/our-team.astro` calls `fetchTeamMembersFromContentful()`.
- `astro.config.mjs` — contains two important custom integrations:
  - `injectDevScript({ scriptPath: '/generated/dev-only.js' })` — dev-only code from `generated/dev-only.js` is injected when running `astro dev`.
  - `patchViteErrorOverlay()` — a Vite plugin that strips the editor link from the error overlay.
- `generated/` and `src/site-components/` — auto-generated Webflow assets. Treat these as generated; avoid manual edits unless regenerating from Webflow.

### Conventions and patterns to follow

- Component types: UI primitives live under `src/components/ui/*` (shadcn-style primitives). Reuse these when composing pages.
- Pages are Astro files in `src/pages/*.astro`. They often fetch data server-side (top-level `await`) and pass data to client React components using `client:load` or `client:idle` directives.
- Server-side code (data fetchers) uses `import.meta.env` for secrets — don't hardcode tokens. Use Vercel environment settings in CI/production.
- Watch/Dev behavior: Vite file watching is configured with polling and ignores `src/site-components` (`astro.config.mjs`), so changes to generated Webflow components may not hot-reload.

### Where to look for common tasks

- Add/modify a page: `src/pages/*.astro` + `src/components/*`.
- Add new data fetching: add GraphQL query and a helper in `src/lib/contentful.ts` and call it from the target page.
- Styling: Tailwind classes across `src/components`; global styles in `src/site-components/global.css` and `src/styles/global.css`.
- Auto-generated UI: `generated/` and `src/site-components/` contain JSX + d.ts shims from Webflow — avoid modifying unless regenerating.

### Debugging and developer workflow notes

- Dev server output appears in terminal where `npm run dev` is run. Use `console.log` on server-side fetchers (e.g., `contentful.ts`) — those logs appear in the terminal.
- Port behavior: `predev` kills port `3000` to avoid collisions; don't remove it without reason.
- No test suite present; run manual smoke checks in the browser and verify server-side logs for Contentful fetches.

### Example quick tasks (how an agent should proceed)

1. To wire new Contentful data into a page:
   - Add a GraphQL query + helper in `src/lib/contentful.ts`.
   - Import and call the helper inside the target `src/pages/*.astro` (top-level `await`).
   - Pass results to a React component (`client:load`) in `src/components` and style with Tailwind.

2. To add a new UI primitive:
   - Add files under `src/components/ui/` following existing patterns (see `button.tsx`, `card.tsx`).
   - Use `clsx` + `class-variance-authority` where appropriate.

### Files to avoid editing unless necessary

- `generated/` and `src/site-components/` — regenerated by Webflow; edits will be lost on regen.
- `node_modules` and build tool internals — changes should be via configuration in `astro.config.mjs` or `package.json` scripts.

If anything here is unclear or you'd like me to expand on specific areas (tests, CI, or how Webflow generation works), tell me which section to expand. I can iterate quickly.
